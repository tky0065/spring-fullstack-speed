package com.example.app.security.annotation;

import org.springframework.security.access.prepost.PostAuthorize;

import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

/**
 * Annotation pour vérifier que l'utilisateur courant est le propriétaire de la ressource
 * Utilise l'expression SpEL pour vérifier que l'ID de l'utilisateur retourné correspond à l'utilisateur actuellement connecté
 */
@Target({ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@PostAuthorize("returnObject.userId == authentication.principal.id")
public @interface IsResourceOwner {
}
